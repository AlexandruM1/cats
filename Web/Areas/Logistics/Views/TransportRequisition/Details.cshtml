@using Cats.Areas.Logistics.Models
@using Kendo.Mvc.UI
@using Cats.Localization;
@using Cats.Helpers

@model Cats.Areas.Logistics.Models.TransportRequisitionViewModel

@{
    ViewBag.Title = Html.Translate("Details");
    Layout = "~/Views/Shared/_MainLayout.cshtml";
}

<h4 class="page-header">@Html.Translate("Transport Requisition Detail") </h4>
@section Toolbar
{
    <a class="btn toolbar-btn" href="#" style="display:none;" target="_blank" id="toolbar_button_print"  title="Print"><i class="icon-print"></i></a>
    <a class="btn toolbar-btn " href="@Url.Action("Index", "TransportRequisition", new { Area = "Logistics" })" data-buttontype="btn_back_to_list"></a>
    @if (Model.StatusID == (int)Cats.Models.Constant.TransportRequisitionStatus.Draft)
    {
        <a class="btn toolbar-btn " href="@Url.Action("Edit", "TransportRequisition", new { Area = "Logistics", id = Model.TransportRequisitionID })" data-buttontype="btn_edit"></a>
        <a class="btn toolbar-btn btn-approve-transportrequisition" href="@Url.Action("Approve", "TransportRequisition", new { id = Model.TransportRequisitionID })" data-buttontype="">@Html.Translate("Approve")</a>
    }

}
<div id='dialogDiv' class='modal hide fade in'>
    <div id='dialogContent'></div>
</div>
<div class="row-fluid form-horizontal ">
    <div class="well span12">
        <div class="span5 ">
            <div class="control-group">
                <div class="control-label">
                    @Html.DisplayName(@Html.Translate("No."))
                </div>
                <div class="controls">
                    @Html.TextBoxFor(model => model.TransportRequisitionNo, new { disabled = "true" })
                </div>
            </div>
            <div class="control-group">
                <div class="control-label">
                    @Html.DisplayName(@Html.Translate("Requested By"))
                </div>
                <div class="controls">
                    @Html.TextBoxFor(model => model.RequestedBy, new { disabled = "true" })
                </div>
            </div>
            <div class="control-group">
                <div class="control-label ">
                    @Html.Label(@Html.Translate("Request Date"), new { @class = "cats-date-pref" })
                </div>
                <div class="controls">
                    @Html.TextBoxFor(model => model.DateRequested, new { disabled = "true" })
                </div>
            </div>
        </div>

        <div class="span5">
            <div class="control-group">
                <div class="control-label">
                    @Html.DisplayName(@Html.Translate("Certified By"))
                </div>
                <div class="controls">
                    @Html.TextBoxFor(model => model.CertifiedBy, new { disabled = "true" })
                </div>
            </div>
            <div class="control-group">
                <div class="control-label">
                    @Html.Label(@Html.Translate("Certified Date"), new { @class = "cats-date-pref" })
                </div>
                <div class="controls">
                    @Html.TextBoxFor(model => model.DateCertified, new { disabled = "true" })
                </div>
            </div>
            <div class="control-group">
                <div class="control-label">
                    @Html.Label(@Html.Translate("Status"))
                </div>
                <div class="controls">
                    @Html.TextBoxFor(model => model.Status, new { disabled = "true", @class = "disabled" })
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        var printurl = "@Url.Action("PrintSummary", "TransportRequisition", new { id = ViewBag.RequisistionId })";
    $("#toolbar_button_print").attr("href", printurl);
});

</script>
@(Html.Kendo().Grid(Model.TransportRequisitionDetailViewModels)
.Name("Grid").Columns(columns =>
                          {

                              columns.Bound(trd => trd.CommodityName).Title(@Html.Translate("Commodity"));
                              columns.Bound(trd => trd.RequisitionNo).Title(@Html.Translate("Requisition No"));
                              columns.Bound(trd => trd.QuanityInQtl).Title(@Html.Translate("Quanity In Qtl")).HtmlAttributes(new { align = "right" }).HeaderHtmlAttributes(new { @class = "cats-unit-pref-grid" });
                              columns.Bound(trd => trd.OrignWarehouse).Title(@Html.Translate("Warehouse Orign"));
                              columns.Bound(trd => trd.Region).Title(@Html.Translate("Region"));
                              columns.Bound(trd => trd.Zone).Title(@Html.Translate("Zone"));

                              columns.Template(@<text>
<a href="@Url.Action("Destinations", "TransportRequisition", new { id = item.RequisitionID, transportRequistionId = Model.TransportRequisitionID })">@Html.Translate("Destinations") (@item.DestinationsCount) </a>
</text>);
                          }).Scrollable()
                          .Groupable()
                          .Sortable()
                          )
<script type="text/javascript">
    $(function () {

        //Optional: turn the chache off
        $.ajaxSetup({ cache: false });

        $('.btn-approve-transportrequisition').click(function () {
            $('#dialogContent').load(this.href, function () {
                $('#dialogDiv').modal({
                    backdrop: 'static',
                    keyboard: true
                }, 'show');
                //bindForm(this);
            });
            return false;
        });
    });
</script>