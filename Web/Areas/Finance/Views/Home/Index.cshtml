@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_MainLayout.cshtml";
    const string PAGE_NAME = "Logistics.Index";
}

@section styles
{
    <link href="~/Content/Dashboard/dashboardcomponents.css" rel="stylesheet" />
}
<div ng-app="myApp">

    <div class="container">

        <div>
            <div class="row" style="border-bottom-width: thin; border-bottom-color: #666; border-bottom-style: inset; margin-top: 5px">

                <div class="pull-left">
                    <h4>Transporter Payment Requests</h4>
                </div>
                <div class="pull-right">
                    <div class="btn-group">
                        <button id="paymentRequestHeader" type="button" class="btn btn-sm btn-default dropdown-toggle" data-toggle="dropdown">
                            <i class="icon-arrow-up"></i>
                            <i class="icon-arrow-down"></i>
                        </button>

                    </div>
                </div>
            </div>
            <div id="paymentRequestContent" class="row">
                <div>&nbsp;</div>
                <div ng-controller="paymentRequestController" class="span11">
                    <div class="portlet">
                        <div class="portlet-header">
                            <h3>

                                <i class=""></i>
                                Payment Status
                            </h3>
                            <ul class="portlet-tools pull-right">
                                <li>
                                    <button class="btn btn-sm btn-default">
                                     <a href="@Url.Action("Index","ValidatedPaymentRequest",new {Area ="Finance"})">Detail</a>   
                                    </button>

                                </li>
                            </ul>
                        </div>

                        <!-- /.portlet-header -->

                        <div class="portlet-content">
                            <th class="table-responsive">
                                <table id="" class="table table-striped table-checkable">
                                    <thead>
                                        <th class="portlet-header" colspan="7">Payment Request</th>
                                        <th class="portlet-header" colspan="3">Reference</th>
                                        <tr>
                                            
                                            <th class="hidden-xs">Number</th>
                                            <th>Transporter Name</th>
                                            <th style="text-align: center">Requested Amount</th>
                                            <th style="text-align: center">Aditional Labour Cost</th>
                                            <th style="text-align: center">Total Amount</th>
                                            <th style="text-align: center">Rejected Amount</th>
                                            <th style="text-align: center">Net Pay</th>
                                          
                                            <th>Date</th>
                                            <th>Check No</th>
                                            <th>PV No</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="req in paymentRequest">
                                            <td class="hidden-xs">{{$index + 1}}</td>
                                            <td>{{req.Transporter}}</td>
                                            <td style="text-align: right; margin-right: 20px">{{req.RequestedAmount}}</td>
                                            <td style="text-align: right; margin-right: 20px">{{req.AditionalLabourCost | number:2}}</td>
                                             <td style="text-align: right; margin-right: 20px">{{req.RequestedAmount + req.AditionalLabourCost | number:2}} </td>
                                            <td style="text-align: right; margin-right: 20px">{{req.RejectedAmount | number:2}}</td>
                                            <td style="text-align: right; margin-right: 20px">{{(req.RequestedAmount + req.AditionalLabourCost) - req.RejectedAmount | number:2}} </td>
                                            <td style="text-align: right; margin-right: 20px">{{req.Date}}</td>
                                            <th>{{req.ChequeNo}}</th>
                                            <th>{{req.PVNo}}</th>
                                        </tr>
                                    </tbody>
                                </table>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>


    <div class="container">

        <div>
            <div class="row" style="border-bottom-width: thin; border-bottom-color: #666; border-bottom-style: inset; margin-top: 5px">

                <div class="pull-left">
                    <h4>Cheque</h4>
                </div>
                <div class="pull-right">
                    <div class="btn-group">
                        <button id="ChequeHeader" type="button" class="btn btn-sm btn-default dropdown-toggle" data-toggle="dropdown">
                            <i class="icon-arrow-up"></i>
                            <i class="icon-arrow-down"></i>
                        </button>

                    </div>
                </div>
            </div>
            <div id="ChequeContent" class="row">
                <div>&nbsp;</div>
                <div ng-controller="ChequeController" class="span11">
                    <div class="portlet">
                        <div class="portlet-header">
                            <h3>

                                <i class=""></i>
                                Cheque Status
                            </h3>
                            <ul class="portlet-tools pull-right">
                                <li>
                                    <button class="btn btn-sm btn-default">
                                        Detail
                                    </button>

                                </li>
                            </ul>
                        </div>

                        <!-- /.portlet-header -->

                        <div class="portlet-content">
                            <th class="table-responsive">
                                <table id="" class="table table-striped table-checkable">
                                    <thead>
                                        <tr>
                                            <th class="hidden-xs">Number</th>
                                            <th>Cheque No</th>
                                            <th>Transporter</th>
                                            <th>Amount</th>
                                            <th>Date Approved</th>
                                            <th>Prepared By</th>
                                            <th>Approved By</th>
                                            
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="req in cheques">
                                            <td class="hidden-xs">{{$index + 1}}</td>
                                            <td>{{req.chequeNo}}</td>
                                            <td>{{req.Transporter}}</td>
                                            <th>{{req.Amount | number:2}}</th>
                                            <th>{{req.DateApproved}}</th>
                                            <th>{{req.ApprovedBy}}</th>
                                            <th>{{req.PreparedBy}}</th>
                                            
                                        </tr>
                                    </tbody>
                                </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


</div>

<script>

    myApp = angular.module('myApp', []);

    myApp.controller('paymentRequestController', ['$scope', '$http', '$rootScope', function ($scope, $http) {


        $scope.paymentRequest = {};
        $http({ method: 'GET', url: '@Url.Action("ReadPaymentRequest", "Home")' }).success(function (data, status, headers, config) {
            console.log(data);
            $scope.paymentRequest = data;
        });
    }]);

    myApp.controller('ChequeController', ['$scope', '$http', '$rootScope', function ($scope, $http) {


        $scope.cheques = {};
        $http({ method: 'GET', url: '@Url.Action("ReadCheques", "Home")' }).success(function (data, status, headers, config) {
            $scope.cheques = data;
            console.log(data);
        });
    }]);
</script>
