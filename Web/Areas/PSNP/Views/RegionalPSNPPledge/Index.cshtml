@using Kendo.Mvc.UI
@model List<Cats.Models.ViewModels.RegionalPSNPPlan.RegionalPSNPPlanViewModel>
@{
    ViewBag.Title = "FDPsCoveredByDonors";
    Layout = "~/Views/Shared/_MainLayout.cshtml";
}

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_MainLayout.cshtml";
    var index = 0;
}
@section LeftBar
{
    @Html.Partial("_RegionalPSNPPledgeLeftBar");
}


<div class="well" style="margin-top: 50px;">
    <div style="width:400px;" align="left">
        <h2>Issue PSNP Pledge</h2>
    </div>
</div>

@(Html.Kendo().Grid<Cats.Models.ViewModels.RegionalPSNPPlan.RegionalPSNPPlanViewModel>()
    .Name("Bid")
    .Columns(columns =>
        {
            columns.Bound(p => p.Region);
            columns.Bound(p => p.Year);
            columns.Bound(p => p.Ration);
            columns.Bound(p => p.Duration);
            columns.Bound(p => p.Status).Title("Status");

        })
    .Pageable()
    .Sortable()
    .Filterable()
    .ClientDetailTemplateId("template")
        //.HtmlAttributes(new { style = "height:430px;" })
    .Editable(editable => editable.Mode(GridEditMode.PopUp))
    .Navigatable()
    .DataSource(dataSource => dataSource
          .Ajax()
          .PageSize(5)
            .Model(model => model.Id(p => p.RegionalPSNPPlanID))
            .Read(read => read.Action("RegionalPSNPPlan_Read", "RegionalPSNPPledge"))
 
     )
     .Events(events => events.DataBound("dataBound"))
      )

<script id="template" type="text/kendo-tmpl">
    
                    @(Html.Kendo().Grid<Cats.Models.ViewModels.Bid.BidDetailViewModel>()
                        .Name("bid_#=BidID#")
                        .Columns(columns =>
                        {
                            //columns.Bound(b => b.BidDetailID).Title("ID").Width(56);
                            columns.Bound(b => b.Region).HtmlAttributes(new { style = "background-color:lightgray" }); 
                            columns.Bound(b => b.AmountForReliefProgram).Title("Relief");
                            columns.Bound(b => b.AmountForPSNPProgram).Title("PSNP");
                            columns.Bound(b => b.BidDocumentPrice);
                            columns.Bound(b => b.CPO);
                            columns.Command(p =>
                            {
                                p.Custom("Edit").Click("bidEdit");
                                p.Custom("Approve").Click("onApprove");
                                p.Custom("Active").Click("onActive");
                            });

                        })
                        .ToolBar(toolBar => toolBar.Save())
                        .Editable(editable => editable.Mode(GridEditMode.InCell))
                        .DataSource(dataSource => dataSource
                            .Ajax()
                            .Batch(true)
                            .ServerOperation(false)
                            .Events(events => events.Error("error_handler"))
                            .PageSize(5)
                            .Model(model =>
                              {
                                  model.Id(p => p.BidDetailID);
                                  model.Field(p => p.RegionID);
                                  model.Field(p => p.BidDetailID).Editable(false);
                                  model.Field(p => p.Region).Editable(false);
                              })
                            .Read(read => read.Action("BidDetail_Read", "Bid", new { bidID = "#=BidID#" }))
                            .Update(update => update.Action("BidDetail_Update", "Bid"))

                        )
                        .Pageable()
                        .Sortable()
                        .ToClientTemplate())
                
</script>